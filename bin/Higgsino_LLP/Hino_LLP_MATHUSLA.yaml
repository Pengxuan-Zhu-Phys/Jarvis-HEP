Scan: 
  name: "Hino_MATHUSLA03"
  save_dir: "&J/Results"

Sampling:
  Method: "Grid" 
  Variables:
    - name: mHino
      description: "Variable X following a Flat distribution for sampling."
      distribution:
        type: Flat
        parameters:
          min: 90
          max: 790
          num: 31
    - name: dm
      description: "Variable X following a Flat distribution for sampling."
      distribution:
        type: Log
        parameters:
          min: 1.e-5
          max: 1.0
          num: 11
EnvReqs:
  OS: 
    - name: linux 
      version: ">=3.10.0"
    - name: Darwin
      version: ">=10.0"
  Check_default_dependences:
    required: True 
    default_yaml_path:  "&J/src/card/environment_default.yaml"

Calculators:
  make_paraller: 10
  path: "&J/WorkShop/Program"
  Modules:
    - name: SUSYHit
      required_modules: []
      clone_shadow: True 
      path: &susyhit_path "&J/WorkShop/Program/SUSYHit/@PackID"
      source: "&J/External/Program/susyhit"
      installation: 
          - "cp ${source}/susyhit.tar.gz ${path}"
          - "cd ${path}"
          - "tar -zxvf susyhit.tar.gz"
          - "make"
          - "cp ${source}/susyhit.in.dk ${path}/susyhit.in"
          - "make"
      initialization: 
          - "cp -r ${source}/slhaspectrum.in ${path}/slhaspectrum.in" 
          - "rm -f susyhit_slha.out"
      execution: 
        path: *susyhit_path
        commands: 
          - "./run slhaspectrum.in" 
        input: 
          - name: sptrin
            path: "&J/WorkShop/Program/SUSYHit/@PackID/slhaspectrum.in" 
            type: "SLHA"
            save: False
            actions:  
              - type: "Replace"
                variables: 
                  - { name: "mN1", placeholder: ">>>>>mN1<<<<<", expression: "mHino - dm"}
                  - { name: "mN2", placeholder: ">>>>>mN2<<<<<", expression: "mHino"}
                  - { name: "mC1", placeholder: ">>>>>mC1<<<<<", expression: "mHino - 0.5*dm"}
        output: 
          - name: spectr 
            path: "&J/WorkShop/Program/SUSYHit/@PackID/susyhit_slha.out" 
            type: "SLHA"
            save: True
            variables:
              - { name: WC1,          block: DECAY,   entry: 1000024 }
              - { name: WN2,          block: DECAY,   entry: 1000023 }
              - { name: BRN22N1a,     block: DECAY,   entry: [1000023, 1000022, 22]}

    - name: HinoGen
      required_modules: [] 
      clone_shadow: True
      path: &hinoGen_path "&J/WorkShop/Program/HinoGen/@PackID"  # Define Anchor point 
      source: "&J/External/Program/HinoGen"
      installation:
          - "cp -r ${source}/* ${path}"
          - "cd ${path}"
          - "./make_generator.sh"
      initialization:
          - "rm -f crossings.json"
          - "rm -f output.hepmc3"
          - "rm -f Mathusla.yoda"
      execution:
        path: *hinoGen_path  # using the Anchor point
        commands:
          - "./run_generator.sh -i ./n2c1.slha -o output.hepmc3 -n 50000 -s 98765"
          - "rivet -a MATHUSLA_N2:GammaFile=ga.json ./output.hepmc3 -o Mathusla.yoda"
        input:
          - name: spectr
            type: "SLHA"
            path: "&J/WorkShop/Program/HinoGen/@PackID/n2c1.slha"
            save: False
            actions:
              - type: "File"
                source: spectr
          - name: gammajs
            type: "Json"
            path: "&J/WorkShop/Program/HinoGen/@PackID/ga.json"
            save: False
            actions:
              - type: "Dump"
                variables: 
                  - {name:  "gamma", expression: "WN2"}
        output:
          - name: oupjson
            path: "&J/WorkShop/Program/HinoGen/@PackID/crossings.json" 
            type: "Json"
            save: True
            variables:
              - { name: x_low }
              - { name: x_high }
              - { name: SR100wophoton_Ethred_0 }
              - { name: SR100wophoton_Ethred_300 }
              - { name: SR100wophoton_Ethred_600 }
              - { name: SR100wophoton_Ethred_1200 }
              - { name: SR100wphoton_Ethred_0 }
              - { name: SR100wphoton_Ethred_300 }
              - { name: SR100wphoton_Ethred_600 }
              - { name: SR100wphoton_Ethred_1200 }
              - { name: SR200wophoton_Ethred_0 }
              - { name: SR200wophoton_Ethred_300 }
              - { name: SR200wophoton_Ethred_600 }
              - { name: SR200wophoton_Ethred_1200 }
              - { name: SR200wphoton_Ethred_0 }
              - { name: SR200wphoton_Ethred_300 }
              - { name: SR200wphoton_Ethred_600 }
              - { name: SR200wphoton_Ethred_1200 }
              - { name: SR40wophoton_Ethred_0 }
              - { name: SR40wophoton_Ethred_300 }
              - { name: SR40wophoton_Ethred_600 }
              - { name: SR40wophoton_Ethred_1200 }
              - { name: SR40wphoton_Ethred_0 }
              - { name: SR40wphoton_Ethred_300 }
              - { name: SR40wphoton_Ethred_600 }
              - { name: SR40wphoton_Ethred_1200 }
        
          - name: outputYoda
            path: "&J/WorkShop/Program/HinoGen/@PackID/Mathusla.yoda" 
            type: "File"
            save: True

